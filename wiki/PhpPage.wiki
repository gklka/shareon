#summary A PHP felület bemutatása
#labels Phase-Implementation

= PHP felület =

A PHP felület célja, hogy egy központi adatbázist használva, melyet a kliensek minden megosztás létrehozásakor frissítenek, részletes információkat szolgáltasson a letölthető tartalmakról. Ezen kívül alkalmas ezen tartalmakhoz metafájlok generálására, melyek segítségével a kliensek a letöltést megkezdhetik.

= Fájlok =

 * `config.php` - a beállításokat tartalmazó fájl<br>
 * `dbfunctions.php` - az adatbáziskezeléssel kapcsolatos funkciókat tartalmazza<br>
 * `download.php` - a .shareon metafájlok generálásáért felelős<br>
 * `footer.php` - a sablon lábléc része<br>
 * `functions.php` - a listázást és a különböző lekérdezéseket megvalósító függvények<br>
 * `header.php` - fejléc sablon<br>
 * `index.php`  - a funkciók szétválasztását végzi<br>
 * `style.css` - stíluslap

= Telepítés =

Egy előre beállított HTTP szerverre van szükség PHP4 értelmezővel a szerver telepítéséhez. Rendelkeznünk kell a MySQL szerver hozzáférésével is (host, felhasználói név, jelszó).

A telepítés során a zip fájlt kitömörítve a fájlokat a webszerver megfelelő könyvtárába kell másolni, mely tetszőleges lehet.

Ez után a dbfunctions.php-ban található értékeket a MySQL szerver hozzáférés alapján megfelelően ki kell tölteni:

 {{{
 $dbhost = 'localhost';
 $dbuser = 'user';
 $dbpass = 'pass';
 }}}

= Használat =

A szerver ezután a szerverbeállításoknak megfelelően, az index.php megnyitásával érhető el. Konkrét feladatunk esetében ez a cím:

http://turul.eet.bme.hu/~mk0804/shareon/index.php

== Megosztás-listázás==

A főoldalon a szerverre bejelentett megosztások találhatóak egy listában. A táblázat a fájlok neveit, a "Seederek", vagyis felöltő felhasználók számát, valamint egy letöltési link oszlopot tartalmazza.

== Megosztó listázás==

A Seederek számára kattintva láthatóvá válik a megosztás száma, az adott megosztó kliens IP-je, valamint egy link, mely az adott kliens által még megosztott fájlok száma.

== Fájl listázás==

Ez utóbbi linkre kattintva egy táblázatot kapunk, mely az adott kliens által megosztott fájlokat tartalmazza, valamint a fájlokat megosztó többi felhasználó számát.

==Letöltés==

A letöltés linkre kattintva a szerver egy .shareon fájlt generál, melyben a letöltéshez szükséges adatok találhatóak meg. Ezt a fájlt a klienssel megnyitva megkezdhető a letöltés.

= Működés =

Az index.php betölti indulásakor a beállításokat, inicializálja a MySQL kapcsolatot, valamint a működéshez szükséges függvények implementációit a megfelelő fájlokból, majd kiírja a sablon fejlécét. Ezek után az m HTTP GET változó értékétől függően megosztás-listázás-, megosztó listázás- ill. fájllistázás módba lépünk, és a megfelelő függvényt meghívjuk. Végül a sablon végét kiírva a HTML oldalt lezárjuk.

A functions.php-ben lévő implementációk egy `queryDb($query, $conn)` szignójú függvény segítségével érik el az SQL szervert. A függvény előnye, hogy egyszerű használhatóságot biztosít a PHP beépített függvényei felhasználásával, valamint eleve könnyen használható formában szolgáltatja vissza a kinyert adatokat.